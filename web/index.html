<head>
    <title>Web Remote Control</title>
    <style>
        fieldset {
            padding: 20px;
        }
    </style>
    <script src="/socket.io.min.js"
        integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh"
        crossorigin="anonymous"></script>
    <script>
        var socket = io.connect('http://localhost:8080');
        window.onload = () => {
            // start by hiding the error message
            document.querySelector('#error').style.display = 'none';
            // show the elements at half transparency, until page loaded.
            document.querySelector('#ui').style.opacity = 0.5;

            socket.on('connect', (data) => {
                // return page elements back to normal on successful connection.
                document.querySelector('#ui').style.opacity = 1;
                
                function step(motor, c) {
                    socket.emit(`${motor}:step`, c);
                }

                // TODO: give keybind to the buttons!
                document.querySelector('#stepCWA').onclick = () => step('motorA', 'cw');
                document.querySelector('#stepCCWA').onclick = () => step('motorA', 'ccw');

                document.querySelector('#stepCWB').onclick = () => step('motorB', 'cw');
                document.querySelector('#stepCCWB').onclick = () => step('motorB', 'ccw');

                document.querySelector('#stepCWC').onclick = () => step('motorC', 'cw');
                document.querySelector('#stepCCWC').onclick = () => step('motorC', 'ccw');

                socket.on('disconnect', () => {
                    // show the error message on server-side socket disconnect.
                    document.querySelector('#error').style.display = 'block';
                    document.querySelector('#error').style.color = 'red';
                });
            });
        };
    </script>
</head>

<body>
    <p id="error">
        <em>NOTE: Do ensure only one instance of this page is open!</em>
    </p>

    <div id='ui'>
        <fieldset>
            <legend>Motor A</legend>
            <button id="stepCWA">Step CW</button>
            <button id="stepCCWA">Step CCW</button>
        </fieldset>
        <fieldset>
            <legend>Motor B</legend>
            <button id="stepCWB">Step CW</button>
            <button id="stepCCWB">Step CCW</button>
        </fieldset>
        <fieldset>
            <legend>Motor C</legend>
            <button id="stepCWC">Step CW</button>
            <button id="stepCCWC">Step CCW</button>
        </fieldset>
    </div>
</body>